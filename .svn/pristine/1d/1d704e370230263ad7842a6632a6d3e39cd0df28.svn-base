package cn.gdeng.nst.api.dto.order;

import java.io.Serializable;
import java.math.BigDecimal;
import java.util.Date;

import org.apache.commons.lang3.StringUtils;

import cn.gdeng.nst.enums.CarTypeEnum;
import cn.gdeng.nst.enums.GoodsTypeEnum;
import cn.gdeng.nst.enums.MemberCerStatusEnum;
import cn.gdeng.nst.enums.OrderBeforeEnum;
import cn.gdeng.nst.enums.OrderInfoStatusEnum;
import cn.gdeng.nst.enums.OrderInfoTransCloseReasonEnum;
import cn.gdeng.nst.enums.PayStatusEnum;
import cn.gdeng.nst.enums.SendGoodsTypeEnum;
import cn.gdeng.nst.enums.SourceStatusEnum;
import cn.gdeng.nst.enums.TransStatusEnum;
import cn.gdeng.nst.util.web.api.ParamProcessUtil;

/**
* @author DJB
* @version 创建时间：2016年12月6日 下午12:15:47
* 订单管理--订单列表  专用  请勿套用
*/

public class OrderBeforeBasicDTO implements Serializable {

	/**
	 * cn.gdeng.nst.api.dto.source
	 */
	private static final long serialVersionUID = 8935333115995029052L;

	private Integer sourceId;

	private Byte sourceType;// 1 干线 2 同城



	private String s_detail;



	private String e_detail;


	/**
	 * 装货时间
	 */
	private String sendDate;
	/**
	 * 货物名称
	 */
	private String goodsName;
	/**
	 * 重量
	 * 
	 */
	private Double totalWeight;
	/**
	 * 体积
	 * 
	 */
	private Integer totalSize;
	/**
	 * 货源所需车长
	 * 
	 */
	private Double carLength;

	/**
	 * 里程
	 * 
	 */
	private Double mileage;

	/**
	 * 货物类型
	 */
	private Byte goodsType;

	/**
	 * 货源所需车型
	 * 
	 */
	private Byte carType;

	/**
	 * 发货方式
	 * 
	 */
	private Byte sendGoodsType;
	
	private  String shipperName;
	
	private String shipperMobile;

	/** 意向运费 */
	private BigDecimal freight;
	/** 车辆id */
	private Integer carId;

	/** 物流状态:0 待支付预付款(待确认) 1待验货(已确认) 2已发货(已确认) 3车主已送达(已确认) 4已关闭(见closeReason) */
	private Byte transStatus;
	
	/*** 货源关闭原因 */
	private Byte closeReason;

	private Date createTime;

	private String timeStr;

	/** 1 货主直发 2 代发 3分配中 4物流公司直发 **/
	private Byte nstRule;
	/** 0 非平台配送 1 平台配送 **/
	private Byte platform;

	/** 货源状态 **/
	private Byte sourceStatus;

	/** 预运单ID **/
	private Integer orderBeforeId;
	/** 预运单状态 **/
	private Byte orderBeforeStatus;
	/** 支付状态 **/
	private Byte orderAgentPayStatus;
	/** 订单ID **/
	private Integer orderInfoId;
	/** 订单状态 **/
	private Byte orderInfoStatus;
	/** 订单号 **/
	private String orderInfoNo;
	/** 订单确认时间 **/
	private Date orderTime; // old 订单确认时间 为了统一， 此字段以后别用了 使用 confirmOrderInfoTime
							// 替换

	/** 信息订单号 **/
	private String orderAgentNo;
	/** 信息订单ID **/
	private Integer orderAgentId;

	/** 收款方用户ID **/
	private Integer payeeUserId;
	/** 收款方账号 **/
	private String payeeMobile;
	/** 收款方姓名 **/
	private String payeeName;
	/** 订单确认时间  **/
	private Date confirmOrderInfoTime;
	/** 信息部确认时间 **/
	private Date agentLogisticTime;
	
	//当前货主名片--显示名片
	
	private String iconUrl;

	private String userName;// 用户姓名

	private Integer memberId;// 用户ID

	private String mobile;

	private Byte cerPersonalStatus;
	

	// 原始货主信息
	/*** 货主id */
	private Integer oriShipperMemberId;
	/*** 货主名称 */
	private String oriShipperName;
	/*** 货主电话 */
	private String oriShipperMobile;

	/** 货主状态 */
	private Byte oriShipperCerStatus;
	/** 货主头像 */
	private String oriShipperIconUrl;

	// 商家信息
	/*** 商家会员id */
	private Integer merchantMemberId;
	/*** 商家名称 */
	private String merchantName;
	/*** 商家电话 */
	private String merchantMobile;
	/** 商铺名称 */
	private String merchantTitle;
	/** 商铺地址 */
	private String merchantAddress;
	/** 商铺 商标 */
	private String merchantLogoUrl;
	
	
	/***  操作状态 **/
	private  Byte operationStatus;
	/**** 操作状态中文解释 ****/
	private String operationStr;
	/**** 操作状态提示语 ****/
	private String markedWords;

	
	public Byte getOperationStatus() {
		return operationStatus;
	}
	public String getOperationStr() {
		return operationStr;
	}

	public String getMarkedWords() {
		return markedWords;
	}
	
	
	public String getUserName() {
		return (String) resultFieldByNstRole(this.userName, getOriShipperName(),getShipperName(), getNstRule());
	}

	public void setUserName(String userName) {
		this.userName = userName;
	}

	public Integer getMemberId() {
		return (Integer) resultFieldByNstRole(this.memberId, getOriShipperMemberId(),null, getNstRule());

	}

	public void setMemberId(Integer memberId) {
		this.memberId = memberId;
	}

	public String getMobile() {
		return (String) resultFieldByNstRole(this.mobile, getOriShipperMobile(),getShipperMobile(), getNstRule());
	}

	public void setMobile(String mobile) {
		this.mobile = mobile;
	}

	public Byte getCerPersonalStatus() {
		return (Byte) resultFieldByNstRole(this.cerPersonalStatus, getOriShipperCerStatus(),null, getNstRule());
	}

	public void setCerPersonalStatus(Byte cerPersonalStatus) {
		this.cerPersonalStatus = cerPersonalStatus;
	}

	public String getCerPersonal() {
		return MemberCerStatusEnum.getNameByCode(getCerPersonalStatus());
	}
	
	public String getIconUrl() {
		return (String) resultFieldByNstRole(this.iconUrl, getOriShipperIconUrl(),null, getNstRule());
	}

	public void setIconUrl(String iconUrl) {
		this.iconUrl = iconUrl;
	}

	

	public String getShipperName() {
		return shipperName;
	}

	public void setShipperName(String shipperName) {
		this.shipperName = shipperName;
	}

	public String getShipperMobile() {
		return shipperMobile;
	}

	public void setShipperMobile(String shipperMobile) {
		this.shipperMobile = shipperMobile;
	}

	public Integer getMerchantMemberId() {
		return merchantMemberId;
	}

	public void setMerchantMemberId(Integer merchantMemberId) {
		this.merchantMemberId = merchantMemberId;
	}

	public String getMerchantName() {
		return merchantName;
	}

	public void setMerchantName(String merchantName) {
		this.merchantName = merchantName;
	}

	public String getMerchantMobile() {
		return merchantMobile;
	}

	public void setMerchantMobile(String merchantMobile) {
		this.merchantMobile = merchantMobile;
	}



	public String getMerchantTitle() {
		return merchantTitle;
	}

	public void setMerchantTitle(String merchantTitle) {
		this.merchantTitle = merchantTitle;
	}

	public String getMerchantAddress() {
		return merchantAddress;
	}

	public void setMerchantAddress(String merchantAddress) {
		this.merchantAddress = merchantAddress;
	}

	
	
	public String getMerchantLogoUrl() {
		return merchantLogoUrl;
	}

	public void setMerchantLogoUrl(String merchantLogoUrl) {
		this.merchantLogoUrl = merchantLogoUrl;
	}

	public Byte getNstRule() {
		return nstRule;
	}

	public void setNstRule(Byte nstRule) {
		this.nstRule = nstRule;
	}

	public Byte getPlatform() {
		return platform;
	}

	public void setPlatform(Byte platform) {
		this.platform = platform;
	}

	public Integer getSourceId() {
		return sourceId;
	}

	public void setSourceId(Integer sourceId) {
		this.sourceId = sourceId;
	}

	public Byte getSourceType() {
		return sourceType;
	}

	public void setSourceType(Byte sourceType) {
		this.sourceType = sourceType;
	}



	public String getS_detail() {
		return s_detail;
	}

	public void setS_detail(String s_detail) {
		if (StringUtils.isNotBlank(s_detail)) {
			this.s_detail = ParamProcessUtil.ridProvinceAndSpliceAddr(s_detail, "/");
		} else {
			this.s_detail = s_detail;
		}
	}



	public String getE_detail() {
		return e_detail;
	}

	public void setE_detail(String e_detail) {
		if (StringUtils.isNotBlank(e_detail)) {
			this.e_detail = ParamProcessUtil.ridProvinceAndSpliceAddr(e_detail, "/");
		} else {
			this.e_detail = e_detail;
		}
	}

	

	public String getSendDate() {
		return ParamProcessUtil.stringDatePattern(sendDate, "yyyy-MM-dd HH:mm:ss", "yyyy-MM-dd HH:mm");
	}

	public void setSendDate(String sendDate) {
		this.sendDate = sendDate;
	}

	public String getGoodsName() {
		return goodsName;
	}

	public void setGoodsName(String goodsName) {
		this.goodsName = goodsName;
	}

	public Double getTotalWeight() {
		return totalWeight;
	}

	public void setTotalWeight(Double totalWeight) {
		this.totalWeight = totalWeight;
	}

	public Integer getTotalSize() {
		return totalSize;
	}

	public void setTotalSize(Integer totalSize) {
		this.totalSize = totalSize;
	}

	public Double getCarLength() {
		return carLength;
	}

	public void setCarLength(Double carLength) {
		this.carLength = carLength;
	}

	public Double getMileage() {
		return mileage;
	}

	public void setMileage(Double mileage) {
		this.mileage = mileage;
	}

	public Byte getGoodsType() {
		return goodsType;
	}

	public void setGoodsType(Byte goodsType) {
		this.goodsType = goodsType;
	}

	public String getGoodsTypeStr() {
		return GoodsTypeEnum.getNameByCode(getGoodsType());
	}

	public Byte getCarType() {
		return carType;
	}

	public void setCarType(Byte carType) {
		this.carType = carType;
	}

	public String getCarTypeStr() {
		return CarTypeEnum.getNameByCode(getCarType());
	}

	public Byte getSendGoodsType() {
		return sendGoodsType;
	}

	public void setSendGoodsType(Byte sendGoodsType) {
		this.sendGoodsType = sendGoodsType;
	}

	public String getSendGoodsTypeStr() {
		return SendGoodsTypeEnum.getNameByCode(getSendGoodsType());
	}

	public Date getCreateTime() {
		return createTime;
	}

	public void setCreateTime(Date createTime) {
		this.createTime = createTime;
	}

	public String getTimeStr() {
		return timeStr;
	}

	public void setTimeStr(String timeStr) {
		this.timeStr = timeStr;
	}

	public Byte getSourceStatus() {
		return sourceStatus;
	}

	public void setSourceStatus(Byte sourceStatus) {
		this.sourceStatus = sourceStatus;
	}

	public String getSourceStatusStr() {
		return SourceStatusEnum.getNameByCode(getSourceStatus());
	}

	public Integer getOrderBeforeId() {
		return orderBeforeId;
	}

	public void setOrderBeforeId(Integer orderBeforeId) {
		this.orderBeforeId = orderBeforeId;
	}

	public Byte getOrderBeforeStatus() {
		return orderBeforeStatus;
	}

	public void setOrderBeforeStatus(Byte orderBeforeStatus) {
		this.orderBeforeStatus = orderBeforeStatus;
	}

	public String getOrderBeforeStatusStr() {
		return OrderBeforeEnum.getNameByCode(getOrderBeforeStatus());
	}

	public Byte getOrderAgentPayStatus() {
		return orderAgentPayStatus;
	}

	public void setOrderAgentPayStatus(Byte orderAgentPayStatus) {
		this.orderAgentPayStatus = orderAgentPayStatus;
	}

	public String getOrderAgentPayStatusStr() {
		if (getOrderAgentPayStatus() == null) {
			return null;
		}
		return PayStatusEnum.getNameByCode((short) getOrderAgentPayStatus());
	}

	public Integer getOrderInfoId() {
		return orderInfoId;
	}

	public void setOrderInfoId(Integer orderInfoId) {
		this.orderInfoId = orderInfoId;
	}

	public Byte getOrderInfoStatus() {
		return orderInfoStatus;
	}

	public void setOrderInfoStatus(Byte orderInfoStatus) {
		this.orderInfoStatus = orderInfoStatus;
	}

	public String getOrderInfoStatusStr() {
		return OrderInfoStatusEnum.getNameByCode(getOrderInfoStatus());
	}

	public String getOrderInfoNo() {
		return orderInfoNo;
	}

	public void setOrderInfoNo(String orderInfoNo) {
		this.orderInfoNo = orderInfoNo;
	}

	public Date getOrderTime() {
		return orderTime;
	}

	public void setOrderTime(Date orderTime) {
		this.orderTime = orderTime;
	}

	public String getOrderAgentNo() {
		return orderAgentNo;
	}

	public void setOrderAgentNo(String orderAgentNo) {
		this.orderAgentNo = orderAgentNo;
	}

	public Integer getOrderAgentId() {
		return orderAgentId;
	}

	public void setOrderAgentId(Integer orderAgentId) {
		this.orderAgentId = orderAgentId;
	}

	public Integer getPayeeUserId() {
		return payeeUserId;
	}

	public void setPayeeUserId(Integer payeeUserId) {
		this.payeeUserId = payeeUserId;
	}

	public String getPayeeMobile() {
		return payeeMobile;
	}

	public void setPayeeMobile(String payeeMobile) {
		this.payeeMobile = payeeMobile;
	}

	public String getPayeeName() {
		return payeeName;
	}

	public void setPayeeName(String payeeName) {
		this.payeeName = payeeName;
	}

	public Date getConfirmOrderInfoTime() {
		return confirmOrderInfoTime;
	}

	public void setConfirmOrderInfoTime(Date confirmOrderInfoTime) {
		this.confirmOrderInfoTime = confirmOrderInfoTime;
	}

	public Date getAgentLogisticTime() {
		return agentLogisticTime;
	}

	public void setAgentLogisticTime(Date agentLogisticTime) {
		this.agentLogisticTime = agentLogisticTime;
	}

	public Integer getOriShipperMemberId() {
		return oriShipperMemberId;
	}

	public void setOriShipperMemberId(Integer oriShipperMemberId) {
		this.oriShipperMemberId = oriShipperMemberId;
	}

	public String getOriShipperName() {
		return oriShipperName;
	}

	public void setOriShipperName(String oriShipperName) {
		this.oriShipperName = oriShipperName;
	}

	public String getOriShipperMobile() {
		return oriShipperMobile;
	}

	public void setOriShipperMobile(String oriShipperMobile) {
		this.oriShipperMobile = oriShipperMobile;
	}



	public Byte getOriShipperCerStatus() {
		return oriShipperCerStatus;
	}

	public void setOriShipperCerStatus(Byte oriShipperCerStatus) {
		this.oriShipperCerStatus = oriShipperCerStatus;
	}

	public String getOriShipperIconUrl() {
		return oriShipperIconUrl;
	}

	public void setOriShipperIconUrl(String oriShipperIconUrl) {
		this.oriShipperIconUrl = oriShipperIconUrl;
	}

	public BigDecimal getFreight() {
		return freight;
	}

	public void setFreight(BigDecimal freight) {
		this.freight = freight;
	}

	public Integer getCarId() {
		return carId;
	}

	public void setCarId(Integer carId) {
		this.carId = carId;
	}

	public Byte getTransStatus() {
		return transStatus;
	}

	public void setTransStatus(Byte transStatus) {
		this.transStatus = transStatus;
	}
	
	public String getTransStatusStr() {
		return TransStatusEnum.getNameByCode(getTransStatus());
	}
	
	
	public Byte getCloseReason() {
		return closeReason;
	}

	public void setCloseReason(Byte closeReason) {
		this.closeReason = closeReason;
	}
	
	
	public String getCloseReasonStr() {
		return OrderInfoTransCloseReasonEnum.getNameByCode(getCloseReason());
	}
	
	/**
	 * 
	 * @Description:
	 * @param orgField 原始的
	 * @param preField 要替换的
	 * @param precedence 存在是 不判断规则
	 * @param nstRole
	 * @return
	 *
	 */
	private Object resultFieldByNstRole(Object orgField,Object preField,Object precedence,Byte nstRole){
		if (precedence!=null) {
			return precedence;
		}
		if (nstRole==null) {
			return orgField;
		}
		switch (nstRole) {
		case 1:
			return preField;
		case 2:
			return orgField;
		case 4:
			return preField;
		case 5:
			return preField;
		case 6:
			return orgField;
		case 7:
			return preField;
		default:
			return orgField;
		}
	}


	
	
	
	
	/**
	 *  已接单 等待确认   nstRule   s.sourceStatus=2  ob.sourceStatus=1
	 *  接单 已确认  待付款    s.sourceStatus=3  ob.sourceStatus=2 oa.orderAgentPayStatus=1
	 *  接单 已确认  付款成功  s.sourceStatus=3 ob.sourceStatus=2 oa.orderAgentPayStatus=2
	 *  拒绝接单    ob.sourceStatus=4
	 *  接单  货主（物流公司）超时未确认   ob.sourceStatus=5
	 *  取消接单  ob.sourceStatus=6
	 *  指派的  未验货   nstRule=6  platform=1  s.sourceStatus=3 ob.sourceStatus=2 oi.orderInfoStatus=1  oi.transStatus=1
	 *  指派的 验货失败  nstRule=6  platform=1 s.sourceStatus=5 ob.sourceStatus=7 oi.orderInfoStatus=3  oi.transStatus=4 oi.closeReason=2
	 *  指派的  验货成功 nstRule=6  platform=1  s.sourceStatus=3 ob.sourceStatus=2 oi.orderInfoStatus=1  oi.transStatus=2
	 *  指派的  验货超时 nstRule=6  platform=1 s.sourceStatus=5 ob.sourceStatus=7 oi.orderInfoStatus=7  oi.transStatus=4 oi.closeReason=3
	 *  指派的  未送达 nstRule=6  platform=1  s.sourceStatus=3 ob.sourceStatus=2 oi.orderInfoStatus=1  oi.transStatus=2
	 *  指派的  已送达 nstRule=6  platform=1  s.sourceStatus=3 ob.sourceStatus=2 oi.orderInfoStatus=1  oi.transStatus=3
	 *  已收货  nstRule=6  platform=1  s.sourceStatus=3 ob.sourceStatus=3 oi.orderInfoStatus=2  
	 *  
	 */
	
	
	
	public Boolean  getInitialOperation(){
		if ( (compareToByte(this.nstRule,(byte)2)||compareToByte(this.nstRule,(byte)4))&&
				compareToByte(this.orderBeforeStatus,(byte)1)) {
			this.operationStatus=1;
			this.operationStr="待确认";
			this.markedWords="您已接单，等待物流公司确认";
		}else if((compareToByte(this.nstRule,(byte)1))&&compareToByte(this.orderBeforeStatus,(byte)1)) {
			this.operationStatus=2;
			this.operationStr="待确认";
			this.markedWords="您已接单，等待货主确认";
		}else if ((compareToByte(this.nstRule,(byte)2)||compareToByte(this.nstRule,(byte)4))
				&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderAgentPayStatus,(byte)1) ) {
			this.operationStatus=3;
			this.operationStr="成功接单，未付款";
			this.markedWords="您已成功接单";
		}else if ((compareToByte(this.nstRule,(byte)2)||compareToByte(this.nstRule,(byte)4))
				&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderAgentPayStatus,(byte)2) ) {
			this.operationStatus=4;
			this.operationStr="成功接单，已付款";
			this.markedWords="您已成功接单";
		}else if ((compareToByte(this.nstRule,(byte)2)||compareToByte(this.nstRule,(byte)4))
				&&compareToByte(this.orderBeforeStatus,(byte)4)  ) {
			this.operationStatus=5;
			this.operationStr="物流公司拒绝你的接单";
			this.markedWords="物流公司不同意您的接单，接单失败";
		}else if ((compareToByte(this.nstRule,(byte)1))&&compareToByte(this.orderBeforeStatus,(byte)4)  ) {
			this.operationStatus=6;
			this.operationStr="货主拒绝你的接单";
			this.markedWords="货主不同意您的接单，接单失败";
		}else if (compareToByte(this.orderBeforeStatus,(byte)5) ) {
			this.operationStatus=7;
			this.operationStr="接到超时未处理";
			this.markedWords="接单超时未处理，接单失败";
		}else if (compareToByte(this.orderBeforeStatus,(byte)6)  ) {
			this.operationStatus=8;
			this.operationStr="取消接单";
			this.markedWords="您已取消接单";
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)3)&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderInfoStatus,(byte)1)&&compareToByte(this.transStatus,(byte)0)) {
			this.operationStatus=16;
			this.operationStr="指派未支付预付款";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)3)&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderInfoStatus,(byte)1)&&compareToByte(this.transStatus,(byte)1)) {
			this.operationStatus=9;
			this.operationStr="指派未验货";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)5)&&compareToByte(this.orderBeforeStatus,(byte)7) 
				&&compareToByte(this.orderInfoStatus,(byte)3)&&compareToByte(this.transStatus,(byte)3)
				&&compareToByte(this.closeReason,(byte)3)) {
			this.operationStatus=10;
			this.operationStr="指派验货失败";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)3)&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderInfoStatus,(byte)1)&&compareToByte(this.transStatus,(byte)2)) {
			this.operationStatus=11;
			this.operationStr="指派验货成功";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)5)&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderInfoStatus,(byte)7)&&compareToByte(this.transStatus,(byte)4)
				&&compareToByte(this.closeReason,(byte)3)) {
			this.operationStatus=12;
			this.operationStr="指派验货超时";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)3)&&compareToByte(this.orderBeforeStatus,(byte)2) 
				&&compareToByte(this.orderInfoStatus,(byte)1)&&compareToByte(this.transStatus,(byte)3)) {
			this.operationStatus=13;
			this.operationStr="指派已送达";
			this.markedWords=null;
		}else if (compareToByte(this.nstRule,(byte)6)&&compareToByte(this.platform,(byte)1)
				&&compareToByte(this.sourceStatus,(byte)3)&&compareToByte(this.orderBeforeStatus,(byte)3) 
				&&compareToByte(this.orderInfoStatus,(byte)2)) {
			this.operationStatus=14;
			this.operationStr="指派已收货";
			this.markedWords=null;
		}else if (compareToByte(this.sourceStatus,(byte)4)) {
			this.operationStatus=15;
			this.operationStr="货源过期";
			this.markedWords=null;
		}else  {
			this.operationStatus=0;
			this.operationStr="未知";
			this.markedWords=null;
		}
		
		return true;
	}

	

	private boolean compareToByte(Byte param,Byte oldParam){
		if(param==null){
			return false;
		}
		if (param.compareTo(oldParam)==0) {
			return true;
		}
		return false;
		
	}
	
}