<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ include file="../pub/tags.inc" %>


<div id="tb-edit" class="easyui-tabs" style="width:780px;height:550px;overflow-x: hidden !important; overflow-y: hidden !important;">
<div title="车辆信息" style="overflow-y: hidden !important;">	
	<form id="updateForm" method="post" >
	<input type="hidden" name="id" value="${memberCarDTO.id}">
	<div style="height:370px;">
	<center>
	<table>
	<tr>
	<td align="right">车牌号：</td><td><input data-options="required:true"  style="width: 360px;" class="easyui-validatebox" maxlength="15"   name="carNumber" id="carNumber" value="${memberCarDTO.carNumber}" /></td>
	</tr>
	<tr>
	<td align="right">车辆类型：</td><td>
	<select  name="carType" id="carTypes" onClick="carTypeShow()" style="width: 364px;" >
									<c:if test="${memberCarDTO.carType==1}">
										<option value="1">小型面包</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==2}">
										<option value="2">金杯</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==3}">
										<option value="3">小型平板</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==4}">
										<option value="4">中型平板</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==5}">
										<option value="5">小型厢货</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==6}">
										<option value="6">大型厢货</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==7}">
										<option value="7">敞车</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==8}">
										<option value="8">厢式货车</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==9}">
										<option value="9">高栏车</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==10}">
										<option value="10">平板车</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==11}">
										<option value="11">集装箱</option>
									</c:if>
									<c:if test="${memberCarDTO.carType==12}">
									<option value="12">保温车   </option>
									</c:if>
									<c:if test="${memberCarDTO.carType==13}">
									<option value="13">冷藏车   </option>
									</c:if>
									<c:if test="${memberCarDTO.carType==14}">
									<option value="14">活鲜水车 </option>
									</c:if>
									<c:if test="${memberCarDTO.carType==15}">
									<option value="15">其他     </option>
									</c:if>
					</select>
    <div id="carTypeShow" style="display:none;z-index:999;background:#ffffff" >
	<table style="border-bottom:1px solid #ccc;">
	<tr>
	<td></td> <td><span style="cursor:pointer"  onClick="carType(4,'中型平板')">中型平板</span></td><td><span style="cursor:pointer"  onClick="carType(5,'小型厢货')">小型厢货</span></td>
	<td><span style="cursor:pointer"  onClick="carType(1,'小型面包')">小型面包</span></td><td><span style="cursor:pointer"  onClick="carType(2,'金杯')">金杯</span></td><td><span style="cursor:pointer"  onClick="carType(3,'小型平板')">小型平板</span></td>
	</tr>
    <tr>
   <td><span style="cursor:pointer"  onClick="carType(3,'大型厢货')">大型厢货</span></td> <td><span style="cursor:pointer"  onClick="carType(7,'敞车')">敞车</span></td><td><span style="cursor:pointer"  onClick="carType(8,'厢式货车')">厢式货车</span></td>
	<td><span style="cursor:pointer"  onClick="carType(9,'高栏车')">高栏车</span></td><td><span style="cursor:pointer"  onClick="carType(10,'平板车')">平板车</span></td><td><span style="cursor:pointer"  onClick="carType(11,'集装箱')">集装箱</span></td>
	</tr>
	<tr>
	<td><span style="cursor:pointer"  onClick="carType(12,'保温车')">保温车</span></td><td><span style="cursor:pointer"  onClick="carType(13,'冷藏车')">冷藏车</span></td><td><span style="cursor:pointer"  onClick="carType(14,'活鲜水车')">活鲜水车</span></td>
	<td><span style="cursor:pointer"  onClick="carType(15,'其他')">其他</span></td><td></td><td></td>
	</tr>
	</table>
	</div>
	</td>
	</tr>
	<tr>
	<td align="right">车长(米)：</td><td>
	<select name="carLength" id="carLengths" onClick="carLengthShow()" style="width: 364px;">
	<c:choose>
        <c:when test="${memberCarDTO.carLength==-2}">
        <option selected="selected" value="-2">其他</option>
        </c:when>
        <c:otherwise>
        <option selected="selected" value="${memberCarDTO.carLength}">${memberCarDTO.carLength}</option>
        </c:otherwise>
     </c:choose>
	</select>
	  <div id="carLengthShow" style="z-index:999;display:none;background:#ffffff;width:400px;" >
	  <span style="width:80px;display:block;float:left;cursor:pointer">其他</span> <span style="width:80px;display:block;float:left;cursor:pointer">1.7</span> <span style="width:80px;display:block;float:left;cursor:pointer">2.7</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">2</span> <span style="width:80px;display:block;float:left;cursor:pointer">4.2</span> <span style="width:80px;display:block;float:left;cursor:pointer">4.5</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">5</span> <span style="width:80px;display:block;float:left;cursor:pointer">6.2</span> <span style="width:80px;display:block;float:left;cursor:pointer">6.8</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">7.2</span> <span style="width:80px;display:block;float:left;cursor:pointer">7.7</span> <span style="width:80px;display:block;float:left;cursor:pointer">7.8</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">8.2</span> <span style="width:80px;display:block;float:left;cursor:pointer">8.6</span> <span style="width:80px;display:block;float:left;cursor:pointer">8.7</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">9.6</span> <span style="width:80px;display:block;float:left;cursor:pointer">11.7</span> <span style="width:80px;display:block;float:left;cursor:pointer">12.5</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">13</span> <span style="width:80px;display:block;float:left;cursor:pointer">13.5</span> <span style="width:80px;display:block;float:left;cursor:pointer">14</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">15</span> <span style="width:80px;display:block;float:left;cursor:pointer">16</span> <span style="width:80px;display:block;float:left;cursor:pointer">17</span>
      <span style="width:80px;display:block;float:left;cursor:pointer">17.5</span> <span style="width:80px;display:block;float:left;cursor:pointer">18</span> <span style="width:80px;display:block;float:left;cursor:pointer">20</span>
	  </div>
<%-- 	<input name="carLength" id="carLength" value="${memberCarDTO.carLength}"/> --%>
	</td>
	</tr>
	<tr>
	<td align="right">载重(吨)：</td>
	<td>
	<input name="load" id="load" style="width: 360px;" validtype="totalWeight" class="easyui-validatebox" required="true"     value="${memberCarDTO.load}">
	</td>
	</tr>
	<tr> 
	<td align="right">用户手机：</td><td>${memberCarDTO.mobile}</td>
	</tr>
	<tr>
	<td align="right" >用户姓名：</td><td>${memberCarDTO.userName} </td>
	</tr>
	<tr>
	<td align="right" border="1px solid #666">车辆照片：</td><td>
	<a href="${memberCarDTO.vehicleUrl}" data-lightbox="vehicleUrl" width="330"  title="车牌号：${memberCarDTO.carNumber}<br>联系人：${memberCarDTO.userName} <br>联系人手机号：${memberCarDTO.mobile}">
	  <img src="${memberCarDTO.vehicleUrl}" alt="" width="120" height="80"/>
	 </a>
     <a href="${memberCarDTO.carHeadUrl}" data-lightbox="carHeadUrl"  width="330" title="车牌号：${memberCarDTO.carNumber}<br>联系人：${memberCarDTO.userName}<br>联系人手机号：${memberCarDTO.mobile}">
	  <img src="${memberCarDTO.carHeadUrl}" alt=""    width="120" height="80"/>
	 </a>
	  <a href="${memberCarDTO.carRearUrl}" data-lightbox="carRearUrl"  width="330" title="车牌号：${memberCarDTO.carNumber}<br>联系人：${memberCarDTO.userName}<br>联系人手机号：${memberCarDTO.mobile}">
	  <img src="${memberCarDTO.carRearUrl}" alt=""    width="120" height="80"/>
	 </a>
	</td>
	</tr>
	</table>
	</center>
</div>
<div align="center">
        <gd:btn btncode='MEMBERCARSAVE'>
		<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-save'" id="icon-save-btn" onclick="update()"> 保存 </a>
		</gd:btn>
		<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#win').dialog('close')">关闭</a>
	</div>
</form>
</div>
</div>	
<script type="text/javascript">
var carleng=true;
var carTypes=true;
$(function(){
	initValidateRules();
	$("#carLengthShow span").click(function(){
		if($(this).html()=="其他"){
		 $("#carLengths").html("<option selected='selected'  value='-2'>其他</option>");	
		}else{
	     $("#carLengths").html("<option selected='selected'  value='"+$(this).html()+"'>"+$(this).html()+"</option>");		
		}
		carleng=true;
		    $("#carLengthShow").hide();
			$("#carLengths").show();  
	});
}) 

function carLengthShow(){
	carleng=false;
	$("#carLengthShow").show();
	$("#carLengths").hide();  
}
function carTypeShow(){
	carTypes=false;
	$("#carTypeShow").show();
	$("#carTypes").hide();  
}
function carType(v,n){
	carTypes=true;
    $("#carTypes").html("<option selected='selected' value='"+v+"'>"+n+"</option>");	
    $("#carTypeShow").hide();
	$("#carTypes").show();  
}


function update() {
	if(!carTypes){
		slideMessage("请选择车辆类型！");
	}
    if(!carleng){
    	slideMessage("请选择车辆长度！");
	}
	
	if ($('#updateForm').form('validate')&&carTypes&&carleng) {
		var url = CONTEXT + "memberCar/memberCarUpdate";
		jQuery.post(url, $('#updateForm').serialize(), function(data) {
			if (data.msg == "success") {
				slideMessage("修改成功！");
				// 刷新父页面列表
				$("#memberCardg").datagrid('reload');
				$('#win').dialog('close');
			} else {
				warningMessage(data.msg);
				return;
			}
		});
	}
}


function initValidateRules(){
	$.extend($.fn.validatebox.defaults.rules, {
		totalWeight:{
			validator: function (value) {
				if(parseFloat(value) == 0){
					return false;
				}
	            return /^\d{1,3}(\.\d{1,2})?$/.test(value);
			},
	        message: '请输入正确的范围，可填范围0.01-999.99 ，不能为0'
		}
	});
}

</script>



