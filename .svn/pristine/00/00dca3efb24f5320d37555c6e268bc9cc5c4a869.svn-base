/**
 * 物流信息处理
 * @author jasmine
 */
var logisticsCtrl  = new NSTApi.client();

NSTApi.client.prototype.infoHandler = {
	/**
	 * 静态变量
	 * 请求地址URL
	 */
	urlItems : {
		queryOrderURL :"/nst-web-api/OrderInfoTrans/queryOrderInfoTransAndSourceExamineByOrderNo"
	},
	/**
	 * 初始化
	 */
	init : function(){
		var orderNo = this.getReqParam("orderNo");
		this.enCode(orderNo, this.getData);
	},
	// 请求物流数据
	getData : function(param){
		var _this = this;
		$.ajax({
			url: this.urlItems.queryOrderURL,
			data : {"param" : param},
			type: "get",
			dataType: "text",
			contentType: "application/json",
			success: function(data){
				_this.deCode(orderNo, _this.render);
				
				//打电话功能
				 $("#phone").on("tap", function(){
					var phone = $(this).attr("data-phone");
					_this.call(phone);
				});
			}
		});
	},
	// 渲染页面
	render : function(data){
		$("#phone").attr("data-phone", data.result.shipperMobile);
		$("#consignee").html($("#consigneeTemp").tmpl(data.result));
		$("#logisMsg").html($("#logisMsgTemp").tmpl(data.result.orderInfoTransList));
		$("#goods").html($("#goodsTemp").tmpl(data.result.sourceExamineDTO));
	}
};

$(function(){
	// 初始化
	logisticsCtrl.infoHandler.init();
});