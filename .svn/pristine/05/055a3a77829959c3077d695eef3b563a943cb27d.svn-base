var NSTApi = {};
NSTApi.client = function(path){
	//编写公共服务
};
NSTApi.client.prototype = {
	/**
	 * 获取请求参数
	 */
	getReqParam : function(name){
		var url = location.search;
		if (url.indexOf("?") != -1) { 
			var str = url.substr(1); 
			strs = str.split("&"); 
			for(var i = 0; i < strs.length; i++){ 
				this[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]); 
			}
			return this[name];
	   } 
	   return null; 
	},
	/**
	 * 判断移动终端浏览器版本
	 */
	appVersion: (function(){
        var u = navigator.userAgent, app = navigator.appVersion;
        return {
            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        	android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
        };
   	})(),
	/**
	 * Android IOS 参数加密处理
	 */
	enCode : function(val, handler){
		// ios处理
		if(this.appVersion.ios){	
			window["handleData"] = function(params){
				handler(params);
			}
			window.webkit.messageHandlers.NativeEncrypt.postMessage('{"data":"{\'orderNo\':' + param + '}","fun":"handleData"}');
		}
		// 安卓处理
		else if(this.appVersion.android){
			var params = JavaH5WebInterface.enCode(JSON.stringify({"orderNo": val}));
			handler(params);
		}
	},
	/**
	 * Android IOS 返回结果解密处理
	 */
	deCode : function(val, handler){
		if(this.appVersion.ios){
			window.webkit.messageHandlers.NativeDecrypt.postMessage('{"data":"'+data+'","fun":"decryptCompleted"}');
			window["decryptCompleted"] = function(data){
				var datasVal = JSON.stringify(data).replace(/\\| /g,"");
				datasVal = JSON.parse(datasVal.substring(1,datasVal.length-1));
				handler(datasVal);
			} 
		}
		else if(this.appVersion.android){
			var adata = JSON.parse(JavaH5WebInterface.deCode(data));
			handler(adata);
		}
	},
	/**
	 * 调用客户端打电话功能
	 */
	call : function(phone){
		if(this.appVersion.ios){	
			window.webkit.messageHandlers.NativeMakeCall.postMessage(phone);
		}
		else if(this.appVersion.android){
			JavaH5WebInterface.callMobile(phone);
		}
	}
};
